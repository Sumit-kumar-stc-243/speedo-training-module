<style>
  .swiper-slide{
    width: {{ block.settings.width }} !important;
  }
</style>

{%- assign video_object = block.settings['video-src'] -%}
{%- assign video_url = '' -%}
{%- if video_object != blank -%}
  {%- for source in video_object.sources -%}
    {%- if source.format == 'mp4' -%}
      {%- assign video_url = source.url -%}
      {%- break -%}
    {%- endif -%}
  {%- endfor -%}

  {%- if video_url == blank and video_object.sources.size > 0 -%}
    {%- assign video_url = video_object.sources[0].url -%}
  {%- endif -%}
{%- endif -%}

{%- assign slide_poster = block.settings.poster | image_url: width: 800 -%}
{%- if slide_poster == blank and video_object != blank -%}
  {%- assign slide_poster = video_object.preview_image | image_url: width: 800 -%}
{%- endif -%}

<video-slide
  data-video-src="{{ video_url }}"
  data-poster="{{ slide_poster }}"
  data-width="{{ block.settings.width }}"
  data-height="{{ block.settings.height }}"
  data-autoplay="{{ block.settings.autoplay }}"
  data-muted="{{ block.settings.muted }}"
  data-loop="{{ block.settings.loop }}"
  data-controls="{{ block.settings.controls }}"
  data-heading="{{ block.settings.video-text }}"
  data-heading-align="{{ block.settings.heading_alignment }}"
  data-heading-top="{{ block.settings.heading_top }}"
  data-heading-size="{{ block.settings.heading_font_size }}"
  data-heading-color="{{ block.settings.heading_color }}"
  data-heading-weight="{{ block.settings.heading_font_weight }}"
>
</video-slide>

{% schema %}
{
  "name": "Video Slide",
  "class": "swiper-slide",
  "settings": [
    {
      "id": "video-text",
      "type": "text",
      "label": "Video Text",
      "default": "Video Title"
    },
    {
      "id": "heading_alignment",
      "type": "select",
      "label": "Heading Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "id": "heading_top",
      "type": "range",
      "label": "Heading Top Position (%)",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 80
    },
    {
      "id": "heading_font_size",
      "type": "range",
      "label": "Heading Font Size (px)",
      "min": 10,
      "max": 100,
      "step": 1,
      "default": 20
    },
    {
      "id": "heading_color",
      "type": "color",
      "label": "Heading Color",
      "default": "#ffffff"
    },
    {
      "id": "heading_font_weight",
      "type": "select",
      "label": "Heading Font Weight",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "id": "video-src",
      "type": "video",
      "label": "Video Source"
    },
    {
      "id": "poster",
      "type": "image_picker",
      "label": "Poster Image"
    },
    {
      "id": "width",
      "type": "text",
      "label": "Width",
      "default": "100%"
    },
    {
      "id": "height",
      "type": "text",
      "label": "Height",
      "default": "auto"
    },
    {
      "id": "autoplay",
      "type": "checkbox",
      "label": "Autoplay (Muted)",
      "default": false,
      "info": "Video will be muted if autoplay is enabled."
    },
    {
      "id": "muted",
      "type": "checkbox",
      "label": "Muted",
      "default": true
    },
    {
      "id": "loop",
      "type": "checkbox",
      "label": "Loop",
      "default": false
    },
    {
      "id": "controls",
      "type": "checkbox",
      "label": "Show Controls",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Video Slide"
    }
  ]
}
{% endschema %}
